# 四星手语平台后端实现计划

## 项目概述
基于前端代码分析，我将为"四星手语"儿童学习平台开发一个完整的后端系统，使用Supabase作为数据库，实现前后端数据交互。

## 技术栈选择
- **后端框架**: Node.js + Express
- **数据库**: Supabase
- **认证**: JWT (JSON Web Tokens)
- **API格式**: RESTful JSON

## 数据库设计

### 1. 用户表 (users)
| 字段名 | 数据类型 | 描述 |
|-------|---------|------|
| id | UUID | 用户唯一标识 |
| name | TEXT | 用户名 |
| avatar | TEXT | 头像URL |
| level | INTEGER | 用户等级 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

### 2. 课程表 (lessons)
| 字段名 | 数据类型 | 描述 |
|-------|---------|------|
| id | TEXT | 课程唯一标识 |
| title | TEXT | 课程标题 |
| pinyin | TEXT | 拼音 |
| thumbnail | TEXT | 缩略图URL |
| tip | TEXT | 小贴士 |
| created_at | TIMESTAMP | 创建时间 |

### 3. 步骤表 (steps)
| 字段名 | 数据类型 | 描述 |
|-------|---------|------|
| id | INTEGER | 步骤ID |
| lesson_id | TEXT | 关联课程ID |
| title | TEXT | 步骤标题 |
| description | TEXT | 步骤描述 |
| image | TEXT | 步骤图片URL |
| order | INTEGER | 步骤顺序 |

### 4. 学习进度表 (learning_progress)
| 字段名 | 数据类型 | 描述 |
|-------|---------|------|
| id | UUID | 记录唯一标识 |
| user_id | UUID | 关联用户ID |
| lesson_id | TEXT | 关联课程ID |
| completed | BOOLEAN | 是否完成 |
| progress | INTEGER | 完成进度百分比 |
| last_accessed | TIMESTAMP | 最后访问时间 |

## API实现计划

### 1. 用户相关API
- `GET /api/users/me` - 获取当前用户信息
- `PUT /api/users/me` - 更新用户信息（用户名、头像）
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录

### 2. 课程相关API
- `GET /api/lessons` - 获取课程列表
- `GET /api/lessons/:id` - 获取课程详情（包含步骤）
- `GET /api/lessons/featured` - 获取推荐课程

### 3. 学习进度API
- `GET /api/progress` - 获取用户学习进度
- `PUT /api/progress/:lessonId` - 更新学习进度

## 后端实现步骤

1. **初始化项目**
   - 创建Node.js项目
   - 安装依赖（express, supabase, jwt等）
   - 配置环境变量

2. **设置Supabase**
   - 创建Supabase项目
   - 设计并创建数据库表
   - 配置数据库连接

3. **实现认证系统**
   - JWT生成和验证
   - 登录/注册功能
   - 中间件保护需要认证的API

4. **实现API路由**
   - 用户相关路由
   - 课程相关路由
   - 学习进度路由

5. **实现业务逻辑**
   - 数据CRUD操作
   - 错误处理
   - 日志记录

6. **前端集成**
   - 修改前端API调用
   - 实现用户认证
   - 测试数据交互

## 前端修改计划

1. **创建API服务**
   - 添加API调用函数
   - 实现认证流程

2. **修改数据获取逻辑**
   - 从API获取课程数据
   - 从API获取用户数据

3. **添加错误处理**
   - 处理API调用错误
   - 显示加载状态

4. **优化用户体验**
   - 添加登录/注册界面
   - 实现自动登录

## 预期成果

- 完整的后端API系统
- 与前端无缝集成
- 安全的用户认证
- 高效的数据存储和检索
- 良好的错误处理和用户体验

此计划将确保"四星手语"平台具备完整的前后端功能，为儿童提供一个流畅、安全的手语学习环境。